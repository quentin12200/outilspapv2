{% extends "base.html" %}
{% block title %}Accueil — Plateforme interne{% endblock %}

{% block content %}
{% if current_user %}
<!-- Menu pour utilisateurs connectés -->
<div class="max-w-5xl mx-auto">
  <div class="mb-8 text-center">
    <h1 class="text-4xl font-bold text-gray-900 mb-3">
      Bienvenue, {{ current_user.first_name }} !
    </h1>
    <p class="text-gray-600 mb-4">
      Plateforme de gestion PAP/CSE
    </p>
  </div>

  <!-- Menu principal -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 items-start">
    <div class="md:col-span-2 lg:col-span-3 flex justify-center">
      <div class="max-w-3xl w-full bg-gradient-to-r from-cgt-red/10 to-purple-100 rounded-xl p-6 border border-cgt-red/20 text-center">
        <p class="text-gray-700 leading-relaxed">
          Cette plateforme vous permet de piloter vos invitations PAP Cycle 5, suivre les prochaines échéances électorales et analyser la couverture syndicale CGT sur l'ensemble du territoire. Accédez aux statistiques, générez des rapports intelligents et utilisez notre assistant pour répondre à vos questions.
        </p>
      </div>
    </div>

    <a href="/stats" class="bg-white rounded-xl shadow-md hover:shadow-xl transition p-6 border-2 border-transparent hover:border-cgt-red">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-chart-line text-2xl text-purple-600"></i>
        </div>
        <i class="fas fa-arrow-right text-gray-400"></i>
      </div>
      <h3 class="text-lg font-bold text-gray-900 mb-2">Statistiques</h3>
      <p class="text-sm text-gray-600">Consultez les indicateurs clés, graphiques et tableaux de bord pour suivre vos invitations PAP et la couverture syndicale.</p>
    </a>

    <a href="/invitations" class="bg-white rounded-xl shadow-md hover:shadow-xl transition p-6 border-2 border-transparent hover:border-cgt-red">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-envelope-open-text text-2xl text-blue-600"></i>
        </div>
        <i class="fas fa-arrow-right text-gray-400"></i>
      </div>
      <h3 class="text-lg font-bold text-gray-900 mb-2">Invitations PAP</h3>
      <p class="text-sm text-gray-600">Accédez à la liste complète des invitations PAP Cycle 5 avec filtres, recherche et export des données.</p>
    </a>

    <a href="/calendrier" class="bg-white rounded-xl shadow-md hover:shadow-xl transition p-6 border-2 border-transparent hover:border-cgt-red">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-calendar-alt text-2xl text-green-600"></i>
        </div>
        <i class="fas fa-arrow-right text-gray-400"></i>
      </div>
      <h3 class="text-lg font-bold text-gray-900 mb-2">Calendrier +1000</h3>
      <p class="text-sm text-gray-600">Visualisez les prochaines élections CSE pour les établissements de plus de 1000 salariés avec dates de scrutin.</p>
    </a>

    <a href="/cartographie" class="bg-white rounded-xl shadow-md hover:shadow-xl transition p-6 border-2 border-transparent hover:border-cgt-red">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-map text-2xl text-indigo-600"></i>
        </div>
        <i class="fas fa-arrow-right text-gray-400"></i>
      </div>
      <h3 class="text-lg font-bold text-gray-900 mb-2">Cartographie</h3>
      <p class="text-sm text-gray-600">Explorez la carte de France interactive pour visualiser la répartition géographique des invitations PAP par département.</p>
    </a>

    <a href="/ciblage" class="bg-white rounded-xl shadow-md hover:shadow-xl transition p-6 border-2 border-transparent hover:border-cgt-red">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-crosshairs text-2xl text-orange-600"></i>
        </div>
        <i class="fas fa-arrow-right text-gray-400"></i>
      </div>
      <h3 class="text-lg font-bold text-gray-900 mb-2">Ciblage</h3>
      <p class="text-sm text-gray-600">Identifiez et analysez les établissements prioritaires selon vos critères (effectifs, secteur, région) pour optimiser vos actions.</p>
    </a>

    <a href="/recherche-siret" class="bg-white rounded-xl shadow-md hover:shadow-xl transition p-6 border-2 border-transparent hover:border-cgt-red">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-teal-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-plus-circle text-2xl text-teal-600"></i>
        </div>
        <i class="fas fa-arrow-right text-gray-400"></i>
      </div>
      <h3 class="text-lg font-bold text-gray-900 mb-2">Ajout PAP</h3>
      <p class="text-sm text-gray-600">Recherchez un établissement par SIRET ou raison sociale et ajoutez manuellement une nouvelle invitation PAP.</p>
    </a>

    {% if current_user.role == "admin" %}
    <a href="/admin" class="bg-gradient-to-br from-cgt-red to-cgt-darkred text-white rounded-xl shadow-md hover:shadow-xl transition p-6 border-2 border-cgt-red">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center">
          <i class="fas fa-cog text-2xl text-white"></i>
        </div>
        <i class="fas fa-arrow-right text-white/70"></i>
      </div>
      <h3 class="text-lg font-bold mb-2">Administration</h3>
      <p class="text-sm text-white/80">Gérez les imports de données, les utilisateurs et accédez aux outils d'administration de la plateforme.</p>
    </a>
    {% endif %}

    <a href="/presentation" class="bg-white rounded-xl shadow-md hover:shadow-xl transition p-6 border-2 border-transparent hover:border-cgt-red">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-pink-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-bullseye text-2xl text-pink-600"></i>
        </div>
        <i class="fas fa-arrow-right text-gray-400"></i>
      </div>
      <h3 class="text-lg font-bold text-gray-900 mb-2">Présentation</h3>
      <p class="text-sm text-gray-600">Découvrez la présentation détaillée de la cible PAP Cycle 5 et les objectifs de la campagne syndicale.</p>
    </a>

    <a href="/extraction" class="bg-white rounded-xl shadow-md hover:shadow-xl transition p-6 border-2 border-transparent hover:border-cgt-red">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-scan text-2xl text-yellow-600"></i>
        </div>
        <i class="fas fa-arrow-right text-gray-400"></i>
      </div>
      <h3 class="text-lg font-bold text-gray-900 mb-2">Scanner PAP</h3>
      <p class="text-sm text-gray-600">Scannez et analysez automatiquement vos documents PAP pour extraire les informations clés des invitations.</p>
    </a>

    <!-- Carte Chatbot -->
    <button onclick="ouvrirAssistantExpert()" class="bg-gradient-to-br from-indigo-500 to-purple-600 text-white rounded-xl shadow-md hover:shadow-2xl transition p-6 border-2 border-indigo-600 text-left group">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center">
          <i class="fas fa-comments text-2xl text-white"></i>
        </div>
        <i class="fas fa-arrow-right text-white/70 group-hover:text-white"></i>
      </div>
      <h3 class="text-lg font-bold mb-2">
        Chatbot
      </h3>
      <p class="text-sm text-white/90">Discutez avec notre assistant intelligent qui répond à vos questions sur vos données PAP en langage naturel.</p>
    </button>

    <!-- Carte Super Rapport -->
    <button onclick="genererRapportIA()" class="bg-gradient-to-br from-pink-500 to-purple-600 text-white rounded-xl shadow-md hover:shadow-2xl transition p-6 border-2 border-pink-600 text-left group">
      <div class="flex items-center justify-between mb-4">
        <div class="w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center">
          <i class="fas fa-chart-line text-2xl text-white"></i>
        </div>
        <i class="fas fa-arrow-right text-white/70 group-hover:text-white"></i>
      </div>
      <h3 class="text-lg font-bold mb-2">
        Super rapport
      </h3>
      <p class="text-sm text-white/90">Générez automatiquement un rapport complet avec analyses approfondies et recommandations stratégiques sur vos cibles PAP.</p>
    </button>
  </div>
</div>

<!-- Inclure les modals chatbot et rapport -->
{% include '_chat_rapport_modals.html' %}

{% else %}
<!-- Page publique pour visiteurs non connectés -->
<div class="flex items-center justify-center min-h-[70vh]">
  <div class="text-center">
    <div class="mb-8">
      <i class="fas fa-lock text-6xl text-cgt-red mb-4"></i>
    </div>
    <h1 class="text-5xl font-bold text-gray-900 mb-4">
      Plateforme interne
    </h1>
    <p class="text-xl text-gray-600 mb-8">
      Accès réservé aux utilisateurs autorisés
    </p>
    <div class="flex justify-center gap-4">
      <a href="/login" class="inline-flex items-center gap-2 px-8 py-4 bg-cgt-red hover:bg-cgt-darkred text-white font-semibold rounded-lg shadow-lg transition">
        <i class="fas fa-sign-in-alt"></i>
        Se connecter
      </a>
      <a href="/signup" class="inline-flex items-center gap-2 px-8 py-4 bg-gray-700 hover:bg-gray-800 text-white font-semibold rounded-lg shadow-lg transition">
        <i class="fas fa-user-plus"></i>
        S'inscrire
      </a>
    </div>
  </div>
</div>
{% endif %}
{% endblock %}
